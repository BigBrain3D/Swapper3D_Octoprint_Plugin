/*
 * View model for Swapper3D
 *
 * Author: BigBrain3D
 * License: AGPLv3
 */
$(function() {
    function Swapper3DViewModel(parameters) {
        var self = this;

        self.settings = parameters[0];

        self.connectSwapper3D = function() {
            console.log("Connect button clicked!");

            // Access values using the observable method
            var serialPort = self.settings.settings.plugins.Swapper3D.serialPort();
            var baudrate = self.settings.settings.plugins.Swapper3D.baudrate();
            console.log("Serial Port: " + serialPort);
            console.log("Baudrate: " + baudrate);

            // Make an API call to your connect function
            $.ajax({
                url: "/api/plugin/Swapper3D",
                type: "POST",
                dataType: "json",
                data: JSON.stringify({
                    command: "connect",
                    port: serialPort,
                    baudrate: baudrate
                }),
                contentType: "application/json; charset=UTF-8"
            }).done(function(data) {
                console.log("Swapper3D connected");
            });
        };
    }

    OCTOPRINT_VIEWMODELS.push([
        Swapper3DViewModel,
        ["settingsViewModel"],
        ["#tab_plugin_Swapper3D"]
    ]);
});
